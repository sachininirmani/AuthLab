# AuthLab — Authentication & Authorization Playground

AuthLab is a **security learning sandbox** built with **Next.js (App Router)** and **Supabase**.
Learners can safely explore core web security concepts with interactive visualizations:

- Authentication (login/logout)
- Authorization (RBAC: USER vs ADMIN)
- JWT (decode + tamper demo)
- Cookies (HttpOnly, Secure, SameSite)
- CSRF (simulated browser decision + SameSite defense)
- Hashing vs Encryption (demo + explanation)
- Threat modeling (attacks → defenses → why they fail)

> ⚠️ This is an educational project. Some labs use *simulation* to explain browser/security behavior.

## 1) Setup (Local)

1. Create a Supabase project.
2. Copy `.env.example` → `.env.local`
3. Fill:
   - `NEXT_PUBLIC_SUPABASE_URL`
   - `NEXT_PUBLIC_SUPABASE_ANON_KEY`

Then:

```bash
npm install
npm run dev
```

Open http://localhost:3000

## 2) Optional: Audit Logs Table

In Supabase SQL editor:

```sql
create table if not exists audit_logs (
  id bigint generated by default as identity primary key,
  user_id uuid,
  email text,
  action text not null,
  ok boolean not null,
  reason text,
  created_at timestamp with time zone default now()
);
```

AuthLab will try to insert audit logs, but it will **not crash** if the table doesn't exist.

## 3) Deployment (Free)

- Deploy to **Vercel** (free).
- Add the same environment variables in the Vercel project settings.

## 4) Sandbox Role Simulation

Learners can switch between `USER` and `ADMIN` using a sandbox control.
This sets an HttpOnly cookie `sim_role`.

- `/api/protected` requires login
- `/api/admin` requires login + simulated ADMIN

## 5) Notes for Learning

- JWT payload is readable (not encrypted), but tamper-resistant (signed).
- Cookies are stored by browser and often sent automatically.
- `SameSite` mitigates CSRF by controlling cross-site cookie sending.
- `HttpOnly` mitigates XSS token theft by blocking JS access to cookies.
